p5.prototype.ScanProcessor=function(){this.HORIZONTAL_LINES=0;this.VERTICAL_LINES=1;this.GRID=2;this.HORIZONTAL_CURVES=3;this.VERTICAL_CURVES=4;this.RELIEF=0;this.RGBXYZ=1;this.mode=this.RELIEF;this.__graphics=createGraphics(10,10);this.__automaticPixelsDataTransferFlag=!0}
p5.prototype.ScanProcessor.prototype.resizeGraphicsWorkaround=function(_g,_w,_h){if(_g===null||_g===undefined){_g=createGraphics(_w,_h);_g.pixelDensity(1)}
else{_g.width=_w;_g.height=_h;_g.elt.width=_w;_g.elt.height=_h;_g.elt.style.width=_w+'px';_g.elt.style.height=_h+'px';_g.pixelDensity(1);_g.loadPixels();_g.elt.setAttribute('style','display: none')}
_g.updatePixels();_g.background(0);_g.loadPixels();if(_w*_h!==_g.pixels.length/4){console.log('[ScanProcessor, resizeGraphicsWorkaround] _w * _h !== _g.pixels.length / 4:'+'\n_w = '+_w+' _h = '+_h+'\n_g.width = '+_g.width+' _g.height = '+_g.height+'\n_w * _h = '+(_w*_h)+'\n_g.pixels.length / 4 = '+(_g.pixels.length/4))}}
p5.prototype.ScanProcessor.prototype.createArray2d=function(_w,_h){var temp_arr=[];for(var temp_x=0;temp_x<_w;temp_x++){var temp_column=[];for(var temp_y=0;temp_y<_h;temp_y++)temp_column[temp_y]=0;temp_arr[temp_x]=temp_column}
return temp_arr}
p5.prototype.ScanProcessor.prototype.draw=function(_arr2d,_dst,_mode,_x,_y,_z,_w,_h,_d){if(_arr2d===null){console.log('[ScanProcessor, mesh] _arr2d === null');return}
if(_arr2d===undefined){console.log('[ScanProcessor, mesh] _arr2d === undefined');return}
if(_mode.hasOwnProperty('width')){this.__draw_texture(_arr2d,_dst,_mode,_x,_y,_z,_w,_h,_d)}
else{switch(_mode){case this.HORIZONTAL_LINES:this.__draw_horizontal_lines(_arr2d,_dst,_x,_y,_z,_w,_h,_d);break;case this.VERTICAL_LINES:this.__draw_vertical_lines(_arr2d,_dst,_x,_y,_z,_w,_h,_d);break;case this.GRID:this.__draw_horizontal_lines(_arr2d,_dst,_x,_y,_z,_w,_h,_d);this.__draw_vertical_lines(_arr2d,_dst,_x,_y,_z,_w,_h,_d);break;case this.HORIZONTAL_CURVES:this.__draw_horizontal_curves(_arr2d,_dst,_x,_y,_z,_w,_h,_d);break;case this.VERTICAL_CURVES:this.__draw_vertical_curves(_arr2d,_dst,_x,_y,_z,_w,_h,_d);break;default:console.log('[ScanProcessor, mesh] unhandled _mode value: '+_mode)}}}
p5.prototype.ScanProcessor.prototype.__draw_texture=function(_arr2d,_dst,_tex,_x,_y,_z,_w,_h,_d){var temp_n_x=_arr2d.length-1;var temp_n_y=_arr2d[0].length-1;_dst.push();_dst.texture(_tex);_dst.textureMode(NORMAL);_dst.translate(_x-0.5*_w,_y-0.5*_h,_z);for(var temp_y=0;temp_y<temp_n_y;temp_y++){for(var temp_x=0;temp_x<temp_n_x;temp_x++){_dst.beginShape();_dst.vertex(_arr2d[temp_x][temp_y][0]*_w,_arr2d[temp_x][temp_y][1]*_h,_arr2d[temp_x][temp_y][2]*_d,_arr2d[temp_x][temp_y][0],_arr2d[temp_x][temp_y][1]);_dst.vertex(_arr2d[temp_x+1][temp_y][0]*_w,_arr2d[temp_x+1][temp_y][1]*_h,_arr2d[temp_x+1][temp_y][2]*_d,_arr2d[temp_x+1][temp_y][0],_arr2d[temp_x+1][temp_y][1]);_dst.vertex(_arr2d[temp_x+1][temp_y+1][0]*_w,_arr2d[temp_x+1][temp_y+1][1]*_h,_arr2d[temp_x+1][temp_y+1][2]*_d,_arr2d[temp_x+1][temp_y+1][0],_arr2d[temp_x+1][temp_y+1][1]);_dst.vertex(_arr2d[temp_x][temp_y+1][0]*_w,_arr2d[temp_x][temp_y+1][1]*_h,_arr2d[temp_x][temp_y+1][2]*_d,_arr2d[temp_x][temp_y+1][0],_arr2d[temp_x][temp_y+1][1]);_dst.endShape()}}
_dst.pop()}
p5.prototype.ScanProcessor.prototype.__draw_horizontal_lines=function(_arr2d,_dst,_x,_y,_z,_w,_h,_d){_dst.push();_dst.noFill();_dst.textureMode(NORMAL);_dst.translate(_x-0.5*_w,_y-0.5*_h,_z);for(var temp_y=0;temp_y<_arr2d[0].length;temp_y++){_dst.beginShape();for(var temp_x=0;temp_x<_arr2d.length;temp_x++)
_dst.vertex(_arr2d[temp_x][temp_y][0]*_w,_arr2d[temp_x][temp_y][1]*_h,_arr2d[temp_x][temp_y][2]*_d);_dst.endShape()}
_dst.pop()}
p5.prototype.ScanProcessor.prototype.__draw_vertical_lines=function(_arr2d,_dst,_x,_y,_z,_w,_h,_d){_dst.push();_dst.noFill();_dst.textureMode(NORMAL);_dst.translate(_x-0.5*_w,_y-0.5*_h,_z);for(var temp_x=0;temp_x<_arr2d.length;temp_x++){_dst.beginShape();for(var temp_y=0;temp_y<_arr2d[0].length;temp_y++)
_dst.vertex(_arr2d[temp_x][temp_y][0]*_w,_arr2d[temp_x][temp_y][1]*_h,_arr2d[temp_x][temp_y][2]*_d);_dst.endShape()}
_dst.pop()}
p5.prototype.ScanProcessor.prototype.__draw_horizontal_curves=function(_arr2d,_dst,_x,_y,_z,_w,_h,_d){_dst.push();_dst.noFill();_dst.textureMode(NORMAL);_dst.translate(_x-0.5*_w,_y-0.5*_h,_z);for(var temp_y=0;temp_y<_arr2d[0].length;temp_y++){_dst.beginShape();for(var temp_x=0;temp_x<_arr2d.length;temp_x++)
_dst.curveVertex(_arr2d[temp_x][temp_y][0]*_w,_arr2d[temp_x][temp_y][1]*_h,_arr2d[temp_x][temp_y][2]*_d);_dst.endShape()}
_dst.pop()}
p5.prototype.ScanProcessor.prototype.__draw_vertical_curves=function(_arr2d,_dst,_x,_y,_z,_w,_h,_d){_dst.push();_dst.noFill();_dst.textureMode(NORMAL);_dst.translate(_x-0.5*_w,_y-0.5*_h,_z);for(var temp_x=0;temp_x<_arr2d.length;temp_x++){_dst.beginShape();for(var temp_y=0;temp_y<_arr2d[0].length;temp_y++)
_dst.curveVertex(_arr2d[temp_x][temp_y][0]*_w,_arr2d[temp_x][temp_y][1]*_h,_arr2d[temp_x][temp_y][2]*_d);_dst.endShape()}
_dst.pop()}
p5.prototype.ScanProcessor.prototype.convert=function(_image,_w,_h){if(arguments.length!==1&&arguments.length!==3){console.log('[ScanProcessor, convert] bad number of arguments: '+arguments.length);return null}
if(_image===null){console.log('[ScanProcessor, convert] _image === null');return null}
if(_image===undefined){console.log('[ScanProcessor, convert] _image === undefined');return null}
if(arguments.length===3){if(isNaN(_w)){console.log('[ScanProcessor, convert] _w is not a number (NaN)');return null}
if(isNaN(_h)){console.log('[ScanProcessor, convert] _h is not a number (NaN)');return null}
_w=Math.floor(Math.abs(_w));_h=Math.floor(Math.abs(_h));if(_w<1)_w=1;if(_h<1)_h=1;if(this.__graphics.width!==_w||this.__graphics.height!==_h){this.resizeGraphicsWorkaround(this.__graphics,_w,_h)}}
else{if(this.__graphics.width!==_image.width||this.__graphics.height!==_image.height){this.resizeGraphicsWorkaround(this.__graphics,_image.width,_image.height)}}
this.__graphics.background(0);this.__graphics.image(_image,0,0,this.__graphics.width,this.__graphics.height);switch(this.mode){case this.RELIEF:return this.__convert_to_relief();break;case this.RGBXYZ:return this.__convert_to_rgbxyz();break;default:console.log('[ScanProcessor, convert] unhandled mode: '+this.mode)}
return this.__convert_to_relief()}
p5.prototype.ScanProcessor.prototype.__convert_to_relief=function(){if(this.__automaticPixelsDataTransferFlag)this.__graphics.loadPixels();var temp_result=this.createArray2d(this.__graphics.width,this.__graphics.height);var temp_maxWeight=3*255;var temp_range={w:this.__graphics.width-1,h:this.__graphics.height-1};var temp_weight,temp_anchor;for(var temp_y=0;temp_y<this.__graphics.height;temp_y++){for(var temp_x=0;temp_x<this.__graphics.width;temp_x++){temp_anchor=(temp_y*this.__graphics.width+temp_x)*4;temp_weight=(this.__graphics.pixels[temp_anchor]+this.__graphics.pixels[temp_anchor+1]+this.__graphics.pixels[temp_anchor+2])/temp_maxWeight;temp_result[temp_x][temp_y]=[temp_x/temp_range.w,temp_y/temp_range.h,temp_weight]}}
if(this.__automaticPixelsDataTransferFlag)this.__graphics.updatePixels();return temp_result}
p5.prototype.ScanProcessor.prototype.__convert_to_rgbxyz=function(){if(this.__automaticPixelsDataTransferFlag)this.__graphics.loadPixels();var temp_result=this.createArray2d(this.__graphics.width,this.__graphics.height);var temp_range={w:this.__graphics.width-1,h:this.__graphics.height-1};var temp_anchor;for(var temp_y=0;temp_y<this.__graphics.height;temp_y++){for(var temp_x=0;temp_x<this.__graphics.width;temp_x++){temp_anchor=(temp_y*this.__graphics.width+temp_x)*4;temp_result[temp_x][temp_y]=[(temp_x/temp_range.w+this.__graphics.pixels[temp_anchor]/255.0)*0.5,(temp_y/temp_range.h+this.__graphics.pixels[temp_anchor+1]/255.0)*0.5,this.__graphics.pixels[temp_anchor+2]/255.0]}}
if(this.__automaticPixelsDataTransferFlag)this.__graphics.updatePixels();return temp_result}